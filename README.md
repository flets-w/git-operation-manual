# WEB サイト運用リポジトリ 運用ルール

このリポジトリは、チームで GitHub を安全かつ効率的に運用するためのドキュメントを管理することを目的としています。全員がこのドキュメントを参照し、以下のルールを必ず遵守してください。

---

## 1. ブランチ戦略

当リポジトリでは、主に 3 種類のブランチを使用して開発を進めます。

- **`main` ブランチ**

  - **役割:** **サブ環境および本番環境の元となる**、常に安定した最新のコードを保持するブランチです。このブランチの状態が常に「正」となります。
  - **ルール:** このブランチへの直接の push は**絶対に禁止**です。変更は必ず`dev`ブランチからの Pull Request を通じて行われます。

- **`dev` ブランチ**

  - **役割:** 全ての作業ブランチを統合し、レビューするためのブランチです。`main`ブランチにマージする前の、一時的なまとめ場所として機能します。**このブランチのファイルが直接サーバーにアップロードされることはありません。**
  - **このリポジトリのデフォルトブランチです。**
  - **ルール:** このブランチへの直接の push は**禁止**です。

- **作業ブランチ**
  - **役割:** 個別の修正や機能追加など、具体的な作業を行うためのブランチです。
  - **ルール:** 必ず`dev`ブランチから作成してください。ブランチの命名については「命名規則」のセクションを参照ください。

---

## 2. 作業の流れ

基本的な開発・修正作業は、以下の流れに沿って行ってください。

1.  **ブランチの作成:** `dev`ブランチから、後述する命名規則に従って作業ブランチを作成します。（例: `update/top-page-text`）
2.  **作業とコミット:** 作成したブランチで、コードの修正や追加作業を行います。作業がキリの良いところまで進んだら、変更内容をコミットしてください。
3.  **Pull Request の作成:** 作業が完了したら、`dev`ブランチに対して Pull Request（PR）を作成します。
4.  **レビュー:** PR を作成したら、チームの誰かにレビューを依頼します。レビュー担当者はコードを確認し、問題なければ承認（Approve）します。
5.  **マージ:** 承認が得られたら、PR を作成した本人が`dev`ブランチにマージします。（マージ方法は必ず **Squash and merge** を選択してください）
6.  **`main`へのマージ準備:** サブ環境での確認が必要な場合は、`dev`から`main`への PR を作成し、責任者の承認を得て`main`にマージします。
7.  **サブ環境へ反映:** `main`ブランチの最新の内容を、手動でサブ環境（ステージング環境）へ FTP アップロードし、最終確認を行います。
8.  **本番環境へ反映:** サブ環境での確認で問題がなければ、同じく`main`ブランチの内容を本番環境へアップロードします。

---

## 3. 命名規則

作業の目的を明確にするため、ブランチの命名には以下の接頭辞を必ず使用してください。

- ### `update/`

  - **用途:** 既存の文言修正、画像差し替え、情報の更新など、**不具合以外の一般的な修正・更新作業**に使用します。
  - **例:** `update/banner-image`, `update/news-text-20250820`

- ### `feature/`

  - **用途:** 新しいページや、これまで無かった新しい機能を追加する**新規開発作業**に使用します。
  - **例:** `feature/add-contact-form`

- ### `fix/`
  - **用途:** プログラムのエラーなど、**明確な不具合（バグ）を修正する作業**に使用します。主に js 関連はこちらを使用
  - **例:** `fix/header-link-error`

---

## 4. Pull Request (プルリクエスト) とレビューのルール

- `main`および`dev`ブランチへの変更は、必ず Pull Request を通じて行います。
- 全ての Pull Request は、作成者以外の**最低 1 名の承認（Approve）**がなければマージできません。（このルール設定は無料版では不可なので、将来的に設定します）
- レビューで指摘された点（Conversation）は、全て解決済み（Resolved）にしてください。
- マージの際は、必ず **Squash and merge** を選択してください。これにより、`dev`や`main`の履歴がクリーンに保たれます。

---

## 5. サブ環境について

- **サブ環境:** `main`ブランチの最新の内容を、手動で FTP アップロードします。

---

## 6. ⚠️ やってはいけないこと（禁止事項）

GitHub での運用を安全かつ効率的に進めるため、以下の行動は絶対に避けてください。
これらのルールを守らないと、コードの混入やコンフリクト（競合）など、重大な事故につながる可能性があります。

- **`main` および `dev` ブランチへの直接のプッシュ**
  `main`と`dev`ブランチへの変更は、必ず Pull Request（プルリク）を通じて行ってください。ローカルでの直接プッシュは、コードレビューや承認のプロセスをスキップし、本番環境のコードに予期せぬ変更をもたらすリスクがあります。

- **`git pull` をせずに作業ブランチを作成する**
  常に最新の `dev` ブランチから作業ブランチを作成する必要があります。`git pull` をせずに作業を始めると、他のメンバーの最新の変更が含まれず、後で大きなコンフリクト（競合）が発生する原因となります。

- **`git status` を確認せずにコミット・プッシュする**
  `git add` や `git commit` を実行する前に、必ず `git status` で変更内容を確認してください。意図しないファイル（ローカルの設定ファイルなど）がコミットされるのを防ぎます。

- **ローカルでコンフリクトを未解決のままマージする**
  `git pull` を実行した際にコンフリクトが発生した場合、解決せずに放置したり、無理にマージしたりしないでください。必ずコンフリクトを丁寧に解消し、意図した通りの変更になっているか確認してからコミットしてください。

- **プルリクエストのレビューを省略する**
  どのような小さな変更であっても、PR のレビューは必須です。これは、人為的なミスを防ぎ、チーム全体の品質を保つための最も重要な安全策です。

- **コミットメッセージを適当に書く**
  変更内容が曖昧なコミット（例: "fix", "update", "修正"など）は、後から履歴を追う際に混乱を招き、問題発生時の原因究明を困難にします。コミットメッセージには「何のために、何を、どう変更したか」を明確に記載してください。

---

## 7. ⚠️ コンフリクト解決時の禁止事項

コンフリクトにいて以下のルールを遵守し、チームの安全と生産性を保ってください。
これらのルールを守らないと、他メンバーの作業内容を誤って削除したり、不具合の原因となるコードを混入させたりする可能性があります。

- **コンフリクトを放置しない**
  コンフリクトが発生したら、速やかにチームに報告してください。一人で悩まず、他のメンバーに相談し、協力して解決にあたることが重要です。

- **相手の変更を無条件に上書きしない**
  コンフリクトの解決は、単にどちらかの変更を残すことではありません。なぜコンフリクトが発生したかを理解し、両方の変更が正しく反映されるようにコードを修正してください。

- **不完全な状態でコミットしない**
  解決したはずのファイルに`<<<<<<<`や`=======`といった Git のマークアップが残っていないか、必ず最終確認を行ってください。不完全な状態のコードをプッシュすると、後続の作業に大きな影響を与えます。
